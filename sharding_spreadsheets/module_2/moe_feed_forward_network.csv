id,require_grads,x1,x2,op_type,op_attr,x1_shape,x1_hidden,x2_shape,x2_hidden,grad_of
x0,N,,,T,,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,,,
wrouter,N,,,T,,"Dmodel/(tp*ep),KExperts",1,,,
yrouter0,N,x0,wrouter,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,"Dmodel/(tp*ep),KExperts",1,
yrouter,N,yrouter0,,R,,"Batch/dp, Seq/sp, KExperts/ep",1,"Batch/dp, Seq*KExperts/(sp*ep)",1
xrouted0,N,x0,,B,"1*KExperts","Batch/dp, Seq/(sp*ep), Dmodel/tp",1,,,
xrouted,N,xrouted0,,R,,"Batch/dp, Seq*KExperts/(sp*ep), Dmodel/ep",1,"Experts/ep, Batch/dp, Seq*KExperts/(Experts*sp), Dmodel/tp",1,
wup,Y,,,T,,"Experts/ep, Dmodel, Dff/tp",1,,,
wgate,Y,,,T,,"Experts/ep, Dmodel, Dff/tp",1,,,
wdown,Y,,,T,,"Experts/ep, Dff/tp, Dmodel",1,,,
xup,N,xrouted,wup,M,"ebsm,emn->ebsn","Experts/ep, Batch/dp, Seq*KExperts/(Experts*sp), Dmodel/tp",1,"Experts/ep, Dmodel, Dff/tp",1,
xgate,N,xrouted,wgate,M,"ebsm,emn->ebsn","Experts/ep, Batch/dp, Seq*KExperts/(Experts*sp), Dmodel/tp",1,"Experts/ep, Dmodel, Dff/tp",1,
xupgate,N,xup,xgate,M,"ebsm,ebsm->ebsm","Experts/ep, Batch/dp, Seq*KExperts/(Experts*sp), Dff/tp",1,"Experts/ep, Batch/dp, Seq*KExperts/(Experts*sp), Dff/tp",1,
xdown,N,xupgate,wdown,M,"ebsm,emn->ebsn","Experts/ep, Batch/dp, Seq*KExperts/(Experts*sp), Dff/tp",1,"Experts/ep, Dff/tp, Dmodel",1,
xpastroute0,N,xdown,,R,,"Experts/ep, Batch/dp, Seq*KExperts/(Experts*sp), Dmodel/tp",1,"Batch/dp, Seq*KExperts/(ep*sp), Dmodel/tp",1,
xpastroute1,N,xpastroute0,,B,"1*1/KExperts","Batch/dp, Seq*KExperts/(sp*ep), Dmodel/tp",1,,,
xpastroute,N,xpastroute1,yrouter,M,"bsm,bs->bsm", "Batch/dp, Seq*KExperts/(sp*tp), Dmodel/tp",1,"Batch/dp, Seq*KExperts/(sp*tp)","1",
res,N,xpastroute,x0,A,,"Batch/dp, Seq/sp, Dmodel/(ep*tp)",1,"Batch/dp, Seq/sp, Dmodel/(ep*tp)",1,
norm,N,res,,E,5,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,,,
dnorm,N,,,T,,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,,,
dres,N,dnorm,,E,5,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,,,   
dxpastroute,N,dres,,I,,"Batch/dp, Seq/(ep*sp), Dmodel/tp",1,,,
dxpastroute1,N,dxpastroute,,B,"1*KExperts","Batch/dp, Seq/(ep*sp), Dmodel/tp",1,,,
dxpastroute0,N,dxpastroute1,yrouter,M,"bsm,bs->bsm","Batch/dp, Seq*KExperts/(sp*ep), Dmodel/tp",1,"Batch/dp, Seq*KExperts/(sp*ep)",1,
dyrouter,N,dxpastroute1,xpastroute0,M,"bsm,bsm->bs","Batch/dp, Seq*KExperts/(sp*ep), Dmodel/tp",1,"Batch/dp, Seq*KExperts/(sp*ep), Dmodel/tp",1,
dxdown,N,dxpastroute0,,R,,"Batch/dp, Seq*KExperts/(ep*sp), Dmodel/tp",1,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dmodel/tp",1,
dwdown,N,dxdown,xupgate,M,"ebsn,ebsm->emn","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dmodel",1,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,
dxupgate,N,dxdown,wdown,M,"ebsn,emn->ebsm","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dmodel",1,"Experts/ep, Dff/tp, Dmodel",1,
dxup,N,dxupgate,xgate,M,"ebsm,ebsm->ebsm","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,
dxgate,N,dxupgate,xup,M,"ebsm,ebsm->ebsm","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,
dwup,N,dxup,xrouted,M,"ebsn,ebsm->emn","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts),Dmodel",1,
dxrouted10,N,dxup,wup,M,"ebsn,emn->ebsm","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,"Experts/ep, Dmodel, Dff/tp",1,
dwgate,N,dxgate,xrouted,M,"ebsn,ebsm->emn","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts),Dmodel",1,
dxrouted11,N,dxgate,wgate,M,"ebsn,emn->ebsm","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dff/tp",1,"Experts/ep, Dmodel, Dff/tp",1,
dxrouted,N,dxrouted10,dxrouted11,A,,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dmodel","1/tp","Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dmodel","1/tp",
dxrouted0,N,dxrouted,,R,,"Experts/ep, Batch/dp, Seq*KExperts/(sp*Experts), Dmodel/tp",1,"Batch/dp, Seq*KExperts/(sp*ep), Dmodel/tp",1,
dx00,N,dxrouted0,,B,"1*1/KExperts","Batch/dp, Seq*KExperts/(sp*ep), Dmodel/tp",1,,,
dx01,N,dres,,I,,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,,,
dx10,N,dx00,dx01,A,,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,"Batch/dp, Seq/sp, Dmodel/(tp*sp)",1,
dyrouter0,N,dyrouter,,R,,"Batch/dp, Seq*KExperts/(sp*ep)",1,"Batch/dp, Seq/sp, KExperts/ep",1,
dwrouter,N,dyrouter0,x0,M,"bsn,bsm->mn","Batch/dp, Seq/sp, KExperts",1,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,
dx02,N,dyrouter0,wrouter,M,"bsn,mn->bsm","Batch/dp, Seq/sp, KExperts",1,"Dmodel/(tp*ep),KExperts",1,
dx0,N,dx02,dx10,A,,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,"Batch/dp, Seq/sp, Dmodel/(tp*ep)",1,
