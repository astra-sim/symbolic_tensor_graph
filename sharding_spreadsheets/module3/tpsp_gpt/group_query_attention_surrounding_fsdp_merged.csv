id,require_grads,x1,x2,op_type,op_attr,x1_shape,x1_hidden,x2_shape,x2_hidden,grad_of,extra_attr
x,N,,,T,"","Batch/dp, (Seq/cp)/tp, Dmodel/1",1,,,,
w_sharded,Y,,,T,,"Dmodel/fsdp, Dmodel/Head, (2*Head+2*KVHead)/tp",1,,,,
w,N,w_sharded,,I,,"Dmodel, Dmodel/Head, (2*Head+2*KVHead)/tp",1,,,,
wqkv,N,w,,SLICE,2:(Head+2*KVHead)/tp,"Dmodel, Dmodel/Head, (2*Head+2*KVHead)/tp",1,,,,
qkv,N,x,wqkv,M,"bsm,mnh->bsnh","Batch/dp, (Seq/cp)/1, Dmodel",1,"Dmodel, Dmodel/Head, (Head+2*KVHead)/tp",1,,
q,N,qkv,,SLICE,"3:Head/tp","Batch/dp, (Seq/cp)/1, Dmodel/Head, (Head+2*KVHead)/tp",1,,,,
k,N,qkv,,SLICE,"3:KVHead/tp","Batch/dp, (Seq/cp)/1, Dmodel/Head, (Head+2*KVHead)/tp",1,,,,
v,N,qkv,,SLICE,"3:KVHead/tp","Batch/dp, (Seq/cp)/1, Dmodel/Head, (Head+2*KVHead)/tp",1,,,,
attn,N,,,T,,"Batch/dp, (Seq/cp)/1, Dmodel/Head, Head/tp",1,,,,
wo,N,w,,SLICE,2:Head/tp,"Dmodel, Dmodel/Head, (2*Head+2*KVHead)/tp",1,,,,
wo1,N,wo,,R,,"Dmodel, Dmodel/Head, Head/tp",1,"Dmodel/Head, Head/tp, Dmodel",1,,
o1,N,attn,wo1,M,"bsmh,mhn->bsn","Batch/dp, (Seq/cp)/1, Dmodel/Head, Head/tp",1,"Dmodel/Head, Head/tp, Dmodel",1,,
o,N,o1,,I,,"Batch/dp, (Seq/cp)/tp, Dmodel/1",1,,,,
do,N,,,T,,"Batch/dp, (Seq/cp)/tp, Dmodel/1",1,,,o,
do1,N,do,,I,,"Batch/dp, (Seq/cp)/1, Dmodel/1",1,,,o1,
dattn,N,do,wo,M,"bsn,mhn->bsmh","Batch/dp, (Seq/cp)/1, Dmodel",1,"Dmodel/Head, Head/tp, Dmodel",1,,
dwo1,N,do,attn,M,"bsn,bsmh->mhn","Batch/dp, (Seq/cp)/1, Dmodel",1,"Batch/dp, (Seq/cp)/1, Dmodel/Head, Head/tp",1,wo,
dwo,N,dwo1,,R,,"Dmodel/Head, Head/tp, Dmodel","1/(dp*cp)","Dmodel, Dmodel/Head, Head/tp","1/(dp*cp)",,
dwo2,N,dwo,,SLICE,"2:(2*Head+2*KVHead)/tp","Dmodel, Dmodel/Head, Head/tp","1/(dp*cp)",,,,
dv,N,,,T,,"Batch/dp, (Seq/cp)/1, Dmodel/Head, KVHead/tp",1,,,v,
dk,N,,,T,,"Batch/dp, (Seq/cp)/1, Dmodel/Head, KVHead/tp",1,,,k,
dq,N,,,T,,"Batch/dp, (Seq/cp)/1, Dmodel/Head, Head/tp",1,,,q,
dkv,N,dv,dk,SLICE,"3:2*KVHead/tp","Batch/dp, (Seq/cp)/1, Dmodel/Head, KVHead/tp",1,"Batch/dp, (Seq/cp)/1, Dmodel/Head, KVHead/tp",1,,
dqkv,N,dkv,dq,SLICE,"3:(2*KVHead+Head)/tp","Batch/dp, (Seq/cp)/1, Dmodel/Head, 2*KVHead/tp",1,"Batch/dp, (Seq/cp)/1, Dmodel/Head, Head/tp",1,qkv,
dwqkv,N,dqkv,x,M,"bsnh,bsm->mnh","Batch/dp, (Seq/cp)/1, Dmodel/Head, (2*KVHead+Head)/tp",1,"Batch/dp, (Seq/cp)/1, Dmodel",1,wqkv,
dwqkv2,N,dwqkv,,SLICE,"2:(2*Head+2*KVHead)/tp","Dmodel, Dmodel/Head, (Head+2*KVHead)/tp","1/(dp*cp)",,,,
dw,N,dwqkv2,dwo2,E2,"0","Dmodel, Dmodel/Head, (2*Head+2*KVHead)/tp","1/(dp*cp)","Dmodel, Dmodel/Head, (2*Head+2*KVHead)/tp","1/(dp*cp)",,
dw_sharded,N,dw,,I,,"Dmodel/fsdp, Dmodel/Head, (2*Head+2*KVHead)/tp",1,,,w_sharded,
dx,N,dqkv,wqkv,M,"bsnh,mnh->bsm","Batch/dp, (Seq/cp)/1, Dmodel/Head, (2*KVHead+Head)/tp",1,"Dmodel, Dmodel/Head, (Head+2*KVHead)/tp",1,x,
