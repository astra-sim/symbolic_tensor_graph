id,require_grads,x1,x2,op_type,op_attr,x1_shape,x1_hidden,x2_shape,x2_hidden,grad_of
x,N,,,T,,"Batch/dp, 1/sp, Dmodel/tp",1,,,
wq,Y,,,T,,"Dmodel/(dp*sp), Dmodel/Head, Head/tp",1,,,
wk,Y,,,T,,"Dmodel/(dp*sp), Dmodel/Head, Head/tp",1,,,
wv,Y,,,T,,"Dmodel/(dp*sp), Dmodel/Head, Head/tp",1,,,
q,N,x,wq,M,"bsm,mnh->bsnh","Batch/dp, 1/sp, Dmodel",1,"Dmodel, Dmodel/Head, Head/tp",1,
kt,N,x,wk,M,"bsm,mnh->bsnh","Batch/dp, 1/sp, Dmodel",1,"Dmodel, Dmodel/Head, Head/tp",1,
vt,N,x,wv,M,"bsm,mnh->bsnh","Batch/dp, 1/sp, Dmodel",1,"Dmodel, Dmodel/Head, Head/tp",1,
kc,N,,,T,,"Batch/dp, (Seq-1)/sp, Dmodel/Head, Head/tp",1,,,
vc,N,,,T,,"Batch/dp, (Seq-1)/sp, Dmodel/Head, Head/tp",1,,,
k,N,kc,kt,C,1,"Batch/dp, (Seq-1)/sp, Dmodel/Head, Head/tp",1,"Batch/dp, 1/sp, Dmodel/Head, Head/tp",1,
v,N,vc,vt,C,1,"Batch/dp, (Seq-1)/sp, Dmodel/Head, Head/tp",1,"Batch/dp, 1/sp, Dmodel/Head, Head/tp",1,
qk,N,q,k,M,"bsnh,bwnh->bswh","Batch/dp, 1, Dmodel/Head, Head/tp",1,"Batch/dp, Seq/sp, Dmodel/Head, Head/tp",1,
qkv,N,qk,v,M,"bswh,bwnh->bsnh","Batch/dp, 1, Seq/sp, Head/tp",1,"Batch/dp, Seq/sp, Dmodel/Head, Head/tp",1,
qkv_reshape,N,qkv,,R,,"Batch/dp, 1/sp, Dmodel/Head, Head/tp",1,"Batch/dp, 1/sp, Dmodel/tp",1,
res,N,qkv_reshape,x,A,,"Batch/dp, 1/sp, Dmodel/tp",1,"Batch/dp, 1/sp, Dmodel/tp",1,
norm,N,res,,E,5,"Batch/dp, 1/sp, Dmodel/tp",1,,,
