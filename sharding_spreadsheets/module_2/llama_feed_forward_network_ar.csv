id,require_grads,x1,x2,op_type,op_attr,x1_shape,x1_hidden,x2_shape,x2_hidden,grad_of,extra_attr
x0,N,,,T,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,,
wup,Y,,,T,,"Dmodel, Dff/tp",1,,,,
wgate,Y,,,T,,"Dmodel, Dff/tp",1,,,,
wdown,Y,,,T,,"Dff/tp, Dmodel",1,,,,
xup,N,x0,wup,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dmodel",1,"Dmodel, Dff/tp",1,,
xgate,N,x0,wgate,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dmodel",1,"Dmodel, Dff/tp",1,,
xupgate,N,xup,xgate,M,"bsm,bsm->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dff/tp",1,,
xdown,N,xupgate,wdown,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dff/tp",1,"Dff/tp, Dmodel",1,,
res,N,xdown,x0,A,,"Batch/dp, Seq/sp, Dmodel/tp",1,"Batch/dp, Seq/sp, Dmodel/tp",1,,
norm,N,res,,E,5,"Batch/dp, Seq/sp, Dmodel/tp",1,,,,
dnorm,N,,,T,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,norm,
xup_recomp,N,x0,wup,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dmodel",1,"Dmodel, Dff/tp",1,,"{""ctrl_deps"": [""dnorm""]}"
xgate_recomp,N,x0,wgate,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dmodel",1,"Dmodel, Dff/tp",1,,"{""ctrl_deps"": [""dnorm""]}"
xupgate_recomp,N,xup_recomp,xgate_recomp,M,"bsm,bsm->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dff/tp",1,,"{""ctrl_deps"": [""dnorm""]}"
xdown_recomp,N,xupgate_recomp,wdown,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dff/tp",1,"Dff/tp, Dmodel",1,,"{""ctrl_deps"": [""dnorm""]}"
dres,N,dnorm,,E,5,"Batch/dp, Seq/sp, Dmodel/tp",1,,,res,
dxdown,N,dres,,I,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,xdown,
dwdown,N,dxdown,xupgate_recomp,M,"bsn,bsm->mn","Batch/dp, Seq/sp, Dmodel",1,"Batch/dp, Seq/sp, Dff/tp",1,wdown,
dxupgate,N,dxdown,wdown,M,"bsn,mn->bsm","Batch/dp, Seq/sp, Dmodel",1,"Dff/tp, Dmodel",1,xupgate,
dxup,N,dxupgate,xgate_recomp,M,"bsm,bsm->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dff/tp",1,xup,
dxgate,N,dxupgate,xup_recomp,M,"bsm,bsm->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dff/tp",1,xgate,
dwup,N,dxup,x0,M,"bsn,bsm->mn","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dmodel",1,wup,
dwgate,N,dxgate,x0,M,"bsn,bsm->mn","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dmodel",1,wgate,
dx00,N,dxup,wup,M,"bsn,mn->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Dmodel, Dff/tp",1,,
dx01,N,dxgate,wgate,M,"bsn,mn->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Dmodel, Dff/tp",1,,
dx001,N,dx00,dx01,A,,"Batch/dp, Seq/sp, Dmodel/tp",1,"Batch/dp, Seq/sp, Dmodel/tp",1,,
dx02,N,dres,,I,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,,
dx0,N,dx02,dx001,A,,"Batch/dp, Seq/sp, Dmodel/tp",1,"Batch/dp, Seq/sp, Dmodel/tp",1,x0,
