id,require_grads,x1,x2,op_type,op_attr,x1_shape,x1_hidden,x2_shape,x2_hidden,grad_of,extra_attr
x0,N,,,T,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,,
wup,Y,,,T,,"Dmodel/(dp*sp), Dff/tp",1,,,,
wgate,Y,,,T,,"Dmodel/(dp*sp), Dff/tp",1,,,,
wdown,Y,,,T,,"Dff/tp, Dmodel/(dp*sp)",1,,,,
wup_full,Y,wup,,I,,"Dmodel, Dff/tp",1,,,,"{""ctrl_deps"": [""x0""]}"
wgate_full,Y,wgate,,I,,"Dmodel, Dff/tp",1,,,,"{""ctrl_deps"": [""x0""]}"
wdown_full,Y,wdown,,I,,"Dff/tp, Dmodel",1,,,,"{""ctrl_deps"": [""x0""]}"
xup,N,x0,wup_full,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dmodel",1,"Dmodel, Dff/tp",1,,
xgate,N,x0,wgate_full,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dmodel",1,"Dmodel, Dff/tp",1,,
xupgate,N,xup,xgate,M,"bsm,bsm->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dff/tp",1,,
xdown,N,xupgate,wdown_full,M,"bsm,mn->bsn","Batch/dp, Seq/sp, Dff/tp",1,"Dff/tp, Dmodel",1,,
res,N,xdown,x0,A,,"Batch/dp, Seq/sp, Dmodel/tp",1,"Batch/dp, Seq/sp, Dmodel/tp",1,,
norm,N,res,,E,5,"Batch/dp, Seq/sp, Dmodel/tp",1,,,,
dnorm,N,,,T,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,norm,
wup_full_2,Y,wup,,I,,"Dmodel, Dff/tp",1,,,,"{""ctrl_deps"": [""dnorm""]}"
wgate_full_2,Y,wgate,,I,,"Dmodel, Dff/tp",1,,,,"{""ctrl_deps"": [""dnorm""]}"
wdown_full_2,Y,wdown,,I,,"Dff/tp, Dmodel",1,,,,"{""ctrl_deps"": [""dnorm""]}"
dres,N,dnorm,,E,5,"Batch/dp, Seq/sp, Dmodel/tp",1,,,res,
dxdown,N,dres,,I,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,xdown,
dwdown,N,dxdown,xupgate,M,"bsn,bsm->mn","Batch/dp, Seq/sp, Dmodel",1,"Batch/dp, Seq/sp, Dff/tp",1,wdown,
dxupgate,N,dxdown,wdown_full_2,M,"bsn,mn->bsm","Batch/dp, Seq/sp, Dmodel",1,"Dff/tp, Dmodel",1,xupgate,
dxup,N,dxupgate,xgate,M,"bsm,bsm->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dff/tp",1,xup,
dxgate,N,dxupgate,xup,M,"bsm,bsm->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dff/tp",1,xgate,
dwup,N,dxup,x0,M,"bsn,bsm->mn","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dmodel",1,wup,
dwgate,N,dxgate,x0,M,"bsn,bsm->mn","Batch/dp, Seq/sp, Dff/tp",1,"Batch/dp, Seq/sp, Dmodel",1,wgate,
dx00,N,dxup,wup_full_2,M,"bsn,mn->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Dmodel, Dff/tp",1,,
dx01,N,dxgate,wgate_full_2,M,"bsn,mn->bsm","Batch/dp, Seq/sp, Dff/tp",1,"Dmodel, Dff/tp",1,,
dx001,N,dx00,dx01,A,,"Batch/dp, Seq/sp, Dmodel/tp",1,"Batch/dp, Seq/sp, Dmodel/tp",1,,
dx02,N,dres,,I,,"Batch/dp, Seq/sp, Dmodel/tp",1,,,,
dx0,N,dx02,dx001,A,,"Batch/dp, Seq/sp, Dmodel/tp",1,"Batch/dp, Seq/sp, Dmodel/tp",1,x0,
